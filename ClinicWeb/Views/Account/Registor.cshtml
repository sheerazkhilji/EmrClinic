<!--@{
    Layout = null;
}


<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Registor</title>
    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")
    <style>


        body {
            padding-top: 50px;
        }

        fieldset {
            border: thin solid #ccc;
            border-radius: 4px;
            padding: 20px;
            padding-left: 40px;
            background: #fbfbfb;
        }

        legend {
            color: #678;
        }

        .form-control {
            width: 95%;
        }

        label small {
            color: #678 !important;
        }

        span.req {
            color: maroon;
            font-size: 112%;
        }
    </style>



</head>



<body>
    <div>

        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <form>
                        <fieldset>


                            <div class="form-group">
                                <label for="username"><span class="req">* </span> User name:  </label>
                                <input class="form-control" type="text" name="username" id="username" placeholder="User name" required />
                                <div id="errLast"></div>
                            </div>
                            <div class="form-group">
                                <label for="email"><span class="req">* </span> Email Address: </label>
                                <input class="form-control" required type="email" name="email" id="email" onchange="email_validate(this.value)" ; />
                                <div class="status" id="status"></div>
                            </div>



                            <div class="form-group">
                                <label for="password"><span class="req">* </span> Password: </label>
                                <input required name="password" type="password" class="form-control inputpass" minlength="4" maxlength="16" id="pass1" />

                                <label for="password"><span class="req">* </span> Password Confirm: </label>
                                <input required name="password" type="password" class="form-control inputpass" minlength="4" maxlength="16" placeholder="Enter again to validate" id="pass2" onkeyup="checkPass(); return false;" />
                                <span id="confirmMessage" class="confirmMessage"></span>
                            </div>

                            <div class="form-group">
                                <label for="phonenumber"><span class="req">* </span> Phone Number: </label>
                                <input required type="text" name="phonenumber" id="phone" class="form-control phone" maxlength="28" onkeyup="validatephone(this);" placeholder="Phone No:" />
                            </div>





                            <div class="form-group">
                                <label for="City"><span class="req">* </span>  City </label>

                                <select class="form-control" name="CId" id="CId">
                                </select>

                            </div>

                            <input type="checkbox" id="Doctor" name="Doctor" value="3">
                            <label for="Doctor"> Doctor</label><br>
                            <input type="checkbox" id="Assistant " name="Assistant " value="2">
                            <label for="Assistant ">Assistant</label><br>
                            <input type="checkbox" id="Admin" name="Admin" value="1">
                            <label for="Admin">Admin</label><br><br>


                                                                <div class="form-group">

                                                                    <button type="button" class="btn btn-success" id="Register">Register</button>

                                                                    @Html.ActionLink("List of Users", "GetALLUser", "Account", null, new { @class = "btn btn-info" })
                                                                </div>


                        </fieldset>
                    </form>-->
<!-- ends register form -->
<!--</div>--><!-- ends col-6 -->
<!--</div>
        </div>


    </div>

    <footer>



        @Scripts.Render("~/bundles/jquery")
        @Scripts.Render("~/bundles/bootstrap")

    </footer>

    <script src="~/Scripts/jquery-3.4.1.min.js"></script>

    <script>


  var apiurl = "@System.Configuration.ConfigurationManager.AppSettings["url"]";

        $(document).ready(function () {

            getallcities();
        });


        function getallcities() {

            $.ajax({

              type: 'GET',
              url: apiurl+'api/getallcities',

                headers: {
                    'Content-Type': 'application/json',
                  'Access-Control-Allow-Origin': apiurl


                }


            }).done(function (res) {


                var data = JSON.parse(res.object);


                var html = '';

                console.log(data);

                $.each(data, function (i, val) {
                    html += `<option value= ` + data[i].CityID + `>` + data[i].City_Name + `</option>`

                });

                $('#CId').append(html);


                console.log(res);
            })
                .fail(function (XMLHttpRequest, textStatus, errorThrown) {
                    console.log("fail");
                })


        }


        function checkPass() {
            //Store the password field objects into variables ...
            var pass1 = document.getElementById('pass1');
            var pass2 = document.getElementById('pass2');
            //Store the Confimation Message Object ...
            var message = document.getElementById('confirmMessage');
            //Set the colors we will be using ...
            var goodColor = "#66cc66";
            var badColor = "#ff6666";
            //Compare the values in the password field
            //and the confirmation field
            if (pass1.value == pass2.value) {
                //The passwords match.
                //Set the color to the good color and inform
                //the user that they have entered the correct password
                pass2.style.backgroundColor = goodColor;
                message.style.color = goodColor;
                message.innerHTML = "Passwords Match"
            } else {
                //The passwords do not match.
                //Set the color to the bad color and
                //notify the user.
                pass2.style.backgroundColor = badColor;
                message.style.color = badColor;
                message.innerHTML = "Passwords Do Not Match!"
            }
        }


        // validate email
        function email_validate(email) {
            var regMail = /^([_a-zA-Z0-9-]+)(\.[_a-zA-Z0-9-]+)*@@([a-zA-Z0-9-]+\.)+([a-zA-Z]{2,3})$/;

            if (regMail.test(email) == false) {
                document.getElementById("status").innerHTML = "<span class='warning'>Email address is not valid yet.</span>";
            }
            else {
                document.getElementById("status").innerHTML = "<span class='valid'>Thanks, you have entered a valid Email address!</span>";
            }
        }




        var username = "";
        var email = "";
        var password = "";
        var confirm = "";
        var cityid = "";
        var phone = "";;
        var roles = [];
        var roleisactive = Array(3);

        $('#Register').click(function () {

            username = $('#username').val();
            email = $('#email').val();
            password = $('#pass1').val();
            confirm = $('#pass2').val();
            cityid = $('#CId').val();
            phone = $('#phone').val();


            var isAllOkay = true;

            if ($('#username').val() == '') {
                isAllOkay = false;
                alert("User name is required")
                return;
            }


            if ($('#email').val() == '') {
                isAllOkay = false;


                alert("email is required");

                return;
            }
            if ($('#pass1').val() == '') {
                isAllOkay = false;
                alert(' password is reqiuired');
                return;
            }


            if ($('#pass2').val() == '') {
                isAllOkay = false;
                alert("Confirm Password is required")
                return;
            }

            if ($('#pass2').val() != $('#pass1').val() ) {
                isAllOkay = false;
                alert("Password does not match")
                return;
            }



            if ($('#CId').val() == '') {
                isAllOkay = false;
                alert('City is required');
                return;
            }


            if ($('#phone').val() == '') {
                isAllOkay = false;
                alert('Phone No:  is required');
                return;
            }

            Submit();


        });


        var email = $('#email').val();
        var pasword = $('#pass1').val();

         function  Submit() {
            cleardatavariables();

            username = $('#username').val();
            email = $('#email').val();
            password = $('#pass1').val();
            confirm = $('#pass2').val();
            cityid = $('#CId').val();
            phone = $('#phone').val();

             $("input[type=checkbox]:checked").each(function (i) {

                 roles.push($("input[type=checkbox]:checked:eq(" + i + ")").val());

             });


            $.ajax({

                type: 'POST',
              url: apiurl +'api/Registration',
                data: JSON.stringify({
                    Rid: '',
                    UserName: username,
                    Email: email,
                    Password: password,
                    ConfirmPassword: confirm,
                    PhoneNumber: phone,

                    Cid: cityid,
                    rolesids: roles,


                }),
                headers: {
                    'Content-Type': 'application/json',
                  'Access-Control-Allow-Origin': apiurl


                }


            }).done(function (res) {

                console.log(res.status);

                debugger;
                if (res.status == "exits") {

                    alert('Email Already Exits');
                }


                else if (res.status == "success") {

                    alert('registered');
                    window.location.href='@Url.Action("GetALLUser","Account")'
                }
                else {
                    alert(res.message);

                }


            })
                .fail(function (XMLHttpRequest, textStatus, errorThrown) {
                    console.log("fail");
                })







        };




        function validatephone(phone) {
            var maintainplus = '';
            var numval = phone.value
            if (numval.charAt(0) == '+') {
                var maintainplus = '';
            }
            curphonevar = numval.replace(/[\\A-Za-z!"£$%^&\,*+_={};:'@@#~,.Š\/<>?|`¬\]\[]/g, '');
            phone.value = maintainplus + curphonevar;
            var maintainplus = '';
            phone.focus;
        }

        function ClearFromFileds() {


            $('#username').val('');
            $('#email').val('');
            $('#pass1').val('');
            $('#pass2').val('');
            $('#CId').val('');
            $('#phone').val('');

            base64StringForm = "";
        }

        function cleardatavariables() {

            username = "";
            email = "";
            password = "";
            confirm = "";
            cityid = "";
            phone = "";;
            roles = [];

        }




    </script>

</body>
</html>-->
